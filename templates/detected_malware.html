{% extends 'base.html' %}
{% block title %}Detected Malware{% endblock %}
{% block content %}

<div class="bg-[#1f1f2e] rounded-2xl p-6 shadow-lg h-[95vh] overflow-y-auto">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-semibold text-white">Detected Malware</h1>
    <a href="/scan-now" class="bg-purple-600 hover:bg-purple-700 text-white text-sm px-4 py-2 rounded-lg shadow">
      + Scan Now
    </a>
  </div>

  <div class="overflow-x-auto rounded-xl shadow">
    <table class="min-w-full bg-[#2a2a3b] text-left text-sm text-gray-300">
      <thead class="bg-[#1e1e2f] text-gray-400 uppercase text-xs">
        <tr>
          <th class="px-4 py-3">Malware Name</th>
          <th class="px-4 py-3">File Path</th>
          <th class="px-4 py-3">Detected On</th>
          <th class="px-4 py-3">Risk</th>
          <th class="px-4 py-3">Status</th>
          <th class="px-4 py-3">Action</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-[#1e1e2f]">
        <tr class="hover:bg-[#2f2f44] transition">
          <td class="px-4 py-3 text-red-300 font-medium">Trojan.GenericKD.4002</td>
          <td class="px-4 py-3 truncate">/home/user/Downloads/crack.exe</td>
          <td class="px-4 py-3">2025-06-19 13:05</td>
          <td class="px-4 py-3 text-red-400 font-semibold">Critical</td>
          <td class="px-4 py-3 text-yellow-300">Quarantined</td>
          <td class="px-4 py-3">
            <a href="javascript:void(0)" onclick="openModal({
              name: 'Trojan.GenericKD.4002',
              path: '/home/user/Downloads/crack.exe',
              date: '2025-06-19 13:05',
              risk: 'Critical',
              status: 'Quarantined'
            })" class="text-purple-400 hover:underline">Analyze</a> |
            <a href="#" class="text-green-400 hover:underline">Mark Safe</a>
          </td>
        </tr>
        <tr class="hover:bg-[#2f2f44] transition">
          <td class="px-4 py-3 text-orange-300 font-medium">Adware.Win32.Fake</td>
          <td class="px-4 py-3 truncate">/tmp/ads-popup.js</td>
          <td class="px-4 py-3">2025-06-18 10:40</td>
          <td class="px-4 py-3 text-orange-400 font-semibold">High</td>
          <td class="px-4 py-3 text-green-300">Deleted</td>
          <td class="px-4 py-3">
            <a href="javascript:void(0)" onclick="openModal({
              name: 'Adware.Win32.Fake',
              path: '/tmp/ads-popup.js',
              date: '2025-06-18 10:40',
              risk: 'High',
              status: 'Deleted'
            })" class="text-purple-400 hover:underline">Details</a>
          </td>
        </tr>
        <tr class="hover:bg-[#2f2f44] transition">
          <td class="px-4 py-3 text-yellow-300 font-medium">Worm.AutoRun.Gen</td>
          <td class="px-4 py-3 truncate">/mnt/usb/autoplay.inf</td>
          <td class="px-4 py-3">2025-06-17 21:10</td>
          <td class="px-4 py-3 text-yellow-400 font-semibold">Medium</td>
          <td class="px-4 py-3 text-yellow-300">Ignored</td>
          <td class="px-4 py-3">
            <a href="javascript:void(0)" onclick="openModal({
              name: 'Worm.AutoRun.Gen',
              path: '/mnt/usb/autoplay.inf',
              date: '2025-06-17 21:10',
              risk: 'Medium',
              status: 'Ignored'
            })" class="text-red-400 hover:underline">Quarantine</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal -->
<div id="malwareModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-[#2a2a3b] p-6 rounded-2xl shadow-2xl w-[90%] max-w-md text-gray-200 relative">
    <button onclick="closeModal()" class="absolute top-2 right-4 text-gray-400 hover:text-white text-2xl">&times;</button>
    <h2 class="text-xl font-semibold mb-4 text-purple-400">Malware Details</h2>
    <p><span class="font-semibold text-gray-400">Name:</span> <span id="malwareName">N/A</span></p>
    <p><span class="font-semibold text-gray-400">Path:</span> <span id="malwarePath">N/A</span></p>
    <p><span class="font-semibold text-gray-400">Detected On:</span> <span id="malwareDate">N/A</span></p>
    <p><span class="font-semibold text-gray-400">Risk:</span> <span id="malwareRisk">N/A</span></p>
    <p><span class="font-semibold text-gray-400">Status:</span> <span id="malwareStatus">N/A</span></p>
  </div>
</div>

<script>
  function openModal(data) {
    document.getElementById('malwareName').textContent = data.name;
    document.getElementById('malwarePath').textContent = data.path;
    document.getElementById('malwareDate').textContent = data.date;
    document.getElementById('malwareRisk').textContent = data.risk;
    document.getElementById('malwareStatus').textContent = data.status;
    document.getElementById('malwareModal').classList.remove('hidden');
  }

  function closeModal() {
    document.getElementById('malwareModal').classList.add('hidden');
  }
</script>

{% endblock %}
